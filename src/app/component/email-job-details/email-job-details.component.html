<div *ngIf="emailJob; else loading" class="email-job-details">
  <h1 class="title">Email Job Details</h1>
  <div class="details-card">
    <p><strong>UUID:</strong> {{ emailJob.uuid }}</p>
    <p><strong>Start Date:</strong> {{ emailJob.startDate | date: 'short' }}</p>
    <p><strong>End Date:</strong> {{ emailJob.endDate ? (emailJob.endDate | date: 'short') : 'N/A' }}</p>
    <p><strong>Status:</strong> {{ emailJob.enabled ? 'Enabled' : 'Disabled' }}</p>
    <p><strong>Email Template UUID:</strong> {{ emailJob.emailTemplate.uuid }}</p>
    <p><strong>Sender UUID:</strong> {{ emailJob.sender.uuid }}</p>
    <p><strong>Receivers:</strong> {{ emailJob.receivers }}</p>
    <p><strong>Frequency:</strong> {{ getFrequencyDisplay(emailJob.frequency) }}</p>

    <!-- If occurrence details are selected, display them here -->
    <div *ngIf="selectedOccurrence; else occurrenceList">
      <h2 class="subheading">Occurrence Details</h2>
      <p><strong>UUID:</strong> {{ selectedOccurrence.uuid }}</p>
      <p><strong>Date:</strong> {{ selectedOccurrence.createdOn | date: 'short' }}</p> <!-- Display createdOn date -->
      <p><strong>Status:</strong>
        <span [ngClass]="{
          'status': true,
          'success': selectedOccurrence.status === StatusEnum.SUCCESS,
          'failed': selectedOccurrence.status !== StatusEnum.SUCCESS
        }">
          {{ selectedOccurrence.status }}
        </span>
      </p>
      <p><strong>Error Description:</strong> {{ selectedOccurrence.errorDescription || 'None' }}</p>
    </div>

    <!-- Display list of occurrences if no specific occurrence is selected -->
    <ng-template #occurrenceList>
      <button class="view-button" (click)="viewOccurrencesDetails()">View Occurrences Details</button>
      <div *ngIf="showOccurrences && occurrences.length > 0">
        <h2 class="subheading">Occurrences</h2>
        <ul>
          <li *ngFor="let occurrence of occurrences">
            <p><strong>Date:</strong> {{ occurrence.createdOn | date: 'short' }}</p> <!-- Display createdOn date -->
            <p><strong>Status:</strong>
              <span [ngClass]="{
                'status': true,
                'success': occurrence.status === StatusEnum.SUCCESS,
                'failed': occurrence.status !== StatusEnum.SUCCESS
              }">
                {{ occurrence.status }}
              </span>
            </p>
            <p><strong>Error Description:</strong> {{ occurrence.errorDescription }}</p>
          </li>
        </ul>
      </div>
    </ng-template>
  </div>

  <!-- Back to Dashboard Button -->
  <button class="back-button" (click)="backToDashboard()">Back to Dashboard</button>
</div>

<ng-template #loading>
  <div class="loading">
    <p>Loading...</p>
  </div>
</ng-template>
